<!DOCTYPE HTML>
<html>
<head>
  <title>Meaningful Chance</title>
  <link href='http://fonts.googleapis.com/css?family=Russo+One' rel='stylesheet' type='text/css'>


  <link href="css/bootstrap.css" rel="stylesheet">
  <link href="css/bootstrap-responsive.css" rel="stylesheet">
  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style>
  .debug {
    /*display: none;*/
  }
  .chance {
    padding: 3px;
    margin: 10px;
  }
  .stat {
    background: gray;
    color: white;
    margin: 5px;
    padding: 5px;
    line-height: 30px;
  }
  .hero-unit {
    margin-top: 10px;
    background: none;
  }
  .examples {
    font-size: 90%;
    padding-top: 15px;
  }
  .answer img {
    margin-bottom: 5px;
    margin-right: 5px;
  }
  .well {
    /*background-image: url("img/background/scribble_light.png");*/
  }
  #result {
    text-align: center;
  }
  #info {
    text-align: right;
  }
  h1 {
    text-align: center;
    font-family: 'Russo One', sans-serif;
  }
  body {
    background-image: url("img/background/gplaypattern.png");
  }
  </style>
</head>
<div class="container">
  <div class="hero-unit">
    <h1>Meaningful Chance</h1>
    <br/>
    <div class="well" id="result">
    </div>
    <form class="well form-search">
      The chances are 1 in
      <input type="text" id="info" class="input-medium search-query"/>
      <button type="submit" class="btn" id="go"> 
      <!-- <i class="icon-circle-arrow-right"> </i> -->
       Make It Meaningful </button>
      <br/>
      <div class="examples"> <!-- from http://www.funny2.com/odds.htm -->
        Examples:
        <a href="#" class="chance" chance="576000">Chance of getting hit by lighting</a>
        <a href="#" class="chance" chance="18000">Chance of being murdered</a>
        <a href="#" class="chance" chance="175000000">Chance of winning the Powerball lottery</a>
      </div>
    </form>
  </div>
</div>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="chances.js"></script>
<script>
  function toText(stat) {
    var num = stat[2];
    var key = stat[1];
    var text = "";
    if (key == "pick_card") {
      text = "drawing the ace of spades";
    } else if(key == "roulette_wheel") {
      text = "spin double zero on a roulette wheel";
    } else if(key == "royal_flush") {
      text = "be delt a royal flush";
    } else if(key == "coin_flip") {
      text = "win a coin flip";
    } else if(key == "roll_dice") {
      text = "roll the same number on two dice";
    }
    if (num == 2) {
      text += " twice";
    } else if(num > 2) {
      text += " " + num + " times in a row";
    }
    var result = "<span class='stat " + key + "'>";
    result += "<img src='img/things/"+key+"_small.png'>";
    result += text;
    result += "</span>";
    return result;
  }

  function failText(t) {
    var s = $("<span class='answer fail'></span>");
    s.text(t);
    $("#result").html(s);
  }

  function doIt() {
    var s;
    var text = $("#info").val();
    text = text.replace(",",""); // remove commas
    if (isNaN(text)) {
      failText("Invalid number");
      return;
    }
    var num = parseInt(text);
    if (!num) {
      failText("Invalid number");
      return;
    }

    var $r = $("#result");
    var $span = $("<span class='answer'></span>");

    var chances = findChances(num)
    var total = chances["total"];
    var results = chances["results"];
    var percent = chances["percent"];

    for(var r=0;r<results.length;r++) {
      if (r != 0) {
        $span.append(" and ")
      }
      $span.append(toText(results[r]));
    }
    if (percent < 10) {
      $span.prepend("You are more likely to ");
    } else if (percent < 30) {
      $span.prepend("You are considerably more likely to ");
    } else {
      $span.prepend("You are far more likely to ");
    }

    $span.attr("total", total); // for debug
    $span.append("<span class='debug'>" + total + " "+ percent +   "</span>");
    $span.hide();
    $r.html($span);
    $span.fadeIn();
  }
  $(document).ready(function() {
    $(".chance").click(function() {
      $("#info").val($(this).attr("chance"));
      doIt();
      return false;
    });
    $("form").submit(function(e) {
      return false;
    });
    $("#go").click(function() {
      doIt();
    });
    if (window.location.hash) {
      var hash = window.location.hash.substring(1);
      $("#info").val(hash);
      doIt();
    } else {
      var $r = $("#result");
      $r.text("Enter a chance to get a more meaningful version of it");
    }
  })
  $(window).bind('hashchange', function() {
    var hash = window.location.hash.substring(1);
    $("#info").val(hash);
    doIt();
  });
</script>
</body>
</html>
